{% load static i18n generic_template_filters %}
<div id="{{view_id|safe}}">
  {% if queryset|length %}
  {% if card_status_indications %}
  <div class="d-flex flex-row-reverse">
    {% for indication in card_status_indications %}
    <span class="m-1" style="cursor: pointer;margin-left: 7px;" {{indication.2|safe}}>
      <span class="oh-dot oh-dot--small me-1 {{indication.0}}"></span>
      {{indication.1}}
    </span>
    {% endfor %}
  </div>
  {% endif %}
  <button class="reload-record" hidden hx-get="{{request.path}}?{{request.GET.urlencode}}" hx-target="#{{view_id|safe}}" hx-swap="outerHTML">
  </button>
    {% if show_filter_tags %}
    {% include "generic/filter_tags.html" %}
    {% endif %}
  <div class="oh-layout--grid-3">
    {% for instance in queryset %}
    <div class="oh-kanban-card {{card_status_class|format:instance|safe}}" {{card_attrs|format:instance|safe}}>
      <div class="oh-kanban-card__avatar">
        <div class="oh-kanban-card__profile-container">
          <img
            src="{{instance|getattribute:details.image_src}}"
            class="oh-kanban-card__profile-image"
            alt="Username"
          />
        </div>
      </div>
      <div class="oh-kanban-card__details">
        <span class="oh-kanban-card__title">{{details.title|format:instance|safe}}</span>
        <span class="oh-kanban-card__subtitle">{{details.subtitle|format:instance|safe}}</span>
      </div>
      {% if actions %}
      <div class="oh-kanban-card__dots" onclick="event.stopPropagation()">
        <div class="oh-dropdown" x-data="{show: false}">
          <button
            class="oh-btn oh-btn--transparent text-muted p-3"
            @click="show = !show"
          >
            <ion-icon name="ellipsis-vertical-sharp"></ion-icon>
          </button>
          <div
            class="oh-dropdown__menu oh-dropdown__menu--dark-border oh-dropdown__menu--right"
            x-show="show"
            @click.outside="show = false"
          >
            <ul class="oh-dropdown__items">
                {% for action in actions %}
                {% if action.accessibility|accessibility:instance %}
                <li class="oh-dropdown__item">
                  <a {{action.attrs|format:instance|safe}}>{{instance|getattribute:action.action|default:action.action}}</a>
                </li>
                {% endif %}
                {% endfor %}
            </ul>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </div>
  {% if queryset.paginator.count %}
  <div class="oh-pagination">
    <span
      class="oh-pagination__page"
      data-toggle="modal"
      data-target="#addEmployeeModal"
      >{% trans "Page" %} {{queryset.number}} {% trans "of" %}
      {{queryset.paginator.num_pages}}</span
    >

    <nav class="oh-pagination__nav">
      <div class="oh-pagination__input-container me-3">
        <span class="oh-pagination__label me-1">{% trans "Page" %}</span>

        <input
          type="number"
          class="oh-pagination__input"
          value="{{queryset.number}}"
          min="1"
          name="page"
          hx-get="{{search_url}}?{{request.GET.urlencode}}&filter_applied=on"
          hx-swap="outerHTML"
          hx-target="#{{view_id|safe}}"
        />
        <span class="oh-pagination__label"
          >{% trans "of" %} {{queryset.paginator.num_pages}}</span
        >
      </div>

      <ul class="oh-pagination__items">
        {% if queryset.has_previous %}
        <li class="oh-pagination__item oh-pagination__item--wide">
          <a
            hx-get="{{search_url}}?{{request.GET.urlencode}}&page=1&filter_applied=on"
            hx-swap="outerHTML"
            hx-target="#{{view_id|safe}}"
            class="oh-pagination__link"
            >{% trans "First" %}</a
          >
        </li>
        <li class="oh-pagination__item oh-pagination__item--wide">
          <a
            hx-get="{{search_url}}?{{request.GET.urlencode}}&page={{ queryset.previous_page_number }}&filter_applied=on"
            hx-swap="outerHTML"
            hx-target="#{{view_id|safe}}"
            class="oh-pagination__link"
            >{% trans "Previous" %}</a
          >
        </li>
        {% endif %} {% if queryset.has_next %}
        <li class="oh-pagination__item oh-pagination__item--wide">
          <a
            hx-get="{{search_url}}?{{request.GET.urlencode}}&page={{ queryset.next_page_number }}&filter_applied=on"
            hx-swap="outerHTML"
            hx-target="#{{view_id|safe}}"
            class="oh-pagination__link"
            >{% trans "Next" %}</a
          >
        </li>
        <li class="oh-pagination__item oh-pagination__item--wide">
          <a
            hx-get="{{search_url}}?{{request.GET.urlencode}}&page={{ queryset.paginator.num_pages }}&filter_applied=on"
            hx-swap="outerHTML"
            hx-target="#{{view_id|safe}}"
            class="oh-pagination__link"
            >{% trans "Last" %}</a
          >
        </li>
        {% endif %}
      </ul>
    </nav>
  </div>
  <script>
    var tabId = $("#{{view_id}}").closest(".oh-tabs__content").attr("id");
    let badge = $(`#badge-${tabId}`);
    let count = "{{queryset.paginator.count}}";
    let label = badge.attr("data-badge-label") || "";
    let title = count + " " + label;
    badge.html(count);
    badge.attr("title", title);
  </script>
  {% endif %}
  {% else %}
  <div class="oh-wrapper" align="center" style="margin-top: 7vh; margin-bottom:7vh;">
    <div align="center">
      <img src="{% static "images/ui/search.svg" %}" class="oh-404__image" alt="Page not found. 404.">
      <h1 class="oh-404__title">{% trans "No Records found" %}</h1>
      <p class="oh-404__subtitle">
        {% trans "No records found." %}
      </p>
    </div>
  </div>
  {% endif %}
</div>
